function _tks(account){this.version="0.98";var self=this;this.account="undefined";this.trackerHost="vietools.com";this.trackerImage="/_tks.gif";this.videoPlayer="xrdPlayer";this.parameters=new Object();this.campaignName="utm_campaign";this.campaignSource="utm_source";this.campaignMedium="utm_medium";this.campaignContent="utm_content";this.url='';this.cid='';this.tdsv=null;this.tdsb=null;this.tdsc=null;this.trackPageview=function(pageUrl,value){var options={};options.url=pageUrl;if(value)options.utval=value;this._track(options);};this._track=function(options){this.url=options.url||'';var params=[],i=0,image=new Image(1,1);var protocol=(location.protcol=='https')?"https:":"http:";var url=protocol+'//'+this.trackerHost+this.trackerImage+"?";for(var p in this.urlParams){var f=this.urlParams[p];value=f();if(value!='undefined'&&value&&value.length>0){params[i++]=p+'='+value;}}
for(var o in options){if(o!='url'&&options[o]){params[i++]=o+'='+encodeURIComponent(options[o]);}}
url+=params.join('&');url+="&uver="+this.version;image.src=url;return;};this.setCid=function(id){self.cid=id;}
this.getCid=function(){return self.cid;}
this.getScreenSize=function(){return screen.width+'x'+screen.height;};this.getColorDepth=function(){return screen.colorDepth+'';};this.getLanguage=function(){return navigator.language||navigator.userLanguage;};this.getCharset=function(){function getMetaHttpEquiv(){var m=document.getElementsByTagName('meta');for(var i in m){if(m[i].httpEquiv&&m[i].httpEquiv.match(/content-type/i)){return m[i].content;}}
return;}
httpEquiv=getMetaHttpEquiv();if(httpEquiv){return httpEquiv.match(/charset=(.*)($|;)/)[1];}else{return;}};this.getTimeZoneOffset=function(){var timezoneOffset=new Date().getTimezoneOffset()*-1;return timezoneOffset+'';};this.getAccount=function(){return self.account;};this.setAccount=function(account){self.account=account;};this.getUserAgent=function(){return navigator.userAgent;};this.getUrl=function(){var url='';if(self.url!==''){url=self.url;}else{url=document.URL;}
return encodeURIComponent(url.replace(/\/$/,''));};this.getPageTitle=function(){return encodeURIComponent(document.title.replace(/^\s*/,'').replace(/\s*$/,''));};this.getReferrer=function(){return encodeURIComponent(document.referrer);};this.getCampName=function(){return encodeURIComponent(self.parameters[self.campaignName]);};this.getCampSource=function(){return encodeURIComponent(self.parameters[self.campaignSource]);};this.getCampMedium=function(){return encodeURIComponent(self.parameters[self.campaignMedium]);};this.getCampContent=function(){return encodeURIComponent(self.parameters[self.campaignContent]);};this.getVisitor=function(){function createTdsv(){self.tdsv=newVisitorId();self.setTdsv(self.tdsv);return self.tdsv;}
function newVisitorId(){return self.getUuid(15);}
function getTdsv(){if(!self.tdsv){self.tdsv=self.getCookie('_tdsv');}
return self.tdsv;}
return(getTdsv()||createTdsv());};this.setTdsv=function(tdsv){self.setCookie('_tdsv',tdsv,720);self.tdsv=tdsv;};this.incrementVisitCount=function(){self.tdsv=self.getVisitor();var currentSessionTimestamp=this.getSession().split('.')[0];var parts=self.tdsv.split('.');if(parts[1]){parts[1]++;}else{parts[1]=1;}
if(parts[2]){parts[3]=parts[2];}
parts[2]=currentSessionTimestamp;self.tdsv=parts.join('.');self.setTdsv(self.tdsv);return self.tdsv;};this.sessionId=function(){return self.getSession().split('.')[0];};this.getSession=function(){function setTdsb(value){self.tdsb=value;self.setCookie('_tdsb',self.tdsb,0.5/24);}
function currentSession(){if(!self.tdsb){self.tdsb=self.getCookie('_tdsb');}
if(!self.tdsc){self.tdsc=self.getCookie('_tdsc');}
if(self.tdsb&&self.tdsc){parts=self.tdsb.split('.');parts[1]++;self.tdsb=parts.join('.');setTdsb(self.tdsb);return self.tdsb;}
return false;}
function createNewSession(){self.tdsb=getNewSessionId()+".0";setTdsb(self.tdsb);self.setCookie('_tdsc',self.tdsb);self.incrementVisitCount();return self.tdsb;}
function getNewSessionId(){var time=new Date();var gmtSecs=Math.round(time.getTime()/1000)+(time.getTimezoneOffset()*60);return gmtSecs;}
return(currentSession()||createNewSession());};this.getFlashVersion=function(){var self=this;self.installed=false;self.raw="";self.major=-1;self.minor=-1;self.revision=-1;self.revisionStr="";var activeXDetectRules=[{"name":"ShockwaveFlash.ShockwaveFlash.7","version":function(obj){return getActiveXVersion(obj);}},{"name":"ShockwaveFlash.ShockwaveFlash.6","version":function(obj){var version="6,0,21";try{obj.AllowScriptAccess="always";version=getActiveXVersion(obj);}catch(err){}
return version;}},{"name":"ShockwaveFlash.ShockwaveFlash","version":function(obj){return getActiveXVersion(obj);}}];var getActiveXVersion=function(activeXObj){var version=-1;try{version=activeXObj.GetVariable("$version");}catch(err){}
return version;};var getActiveXObject=function(name){var obj=-1;try{obj=new ActiveXObject(name);}catch(err){obj={activeXError:true};}
return obj;};var parseActiveXVersion=function(str){var versionArray=str.split(",");return{"raw":str,"major":parseInt(versionArray[0].split(" ")[1],10),"minor":parseInt(versionArray[1],10),"revision":parseInt(versionArray[2],10),"revisionStr":versionArray[2]};};var parseStandardVersion=function(str){var descParts=str.split(/ +/);var majorMinor=descParts[2].split(/\./);var revisionStr=descParts[3];return{"raw":str,"major":parseInt(majorMinor[0],10),"minor":parseInt(majorMinor[1],10),"revisionStr":revisionStr,"revision":parseRevisionStrToInt(revisionStr)};};var parseRevisionStrToInt=function(str){return parseInt(str.replace(/[a-zA-Z]/g,""),10)||self.revision;};if(navigator.plugins&&navigator.plugins.length>0){var type='application/x-shockwave-flash';var mimeTypes=navigator.mimeTypes;if(mimeTypes&&mimeTypes[type]&&mimeTypes[type].enabledPlugin&&mimeTypes[type].enabledPlugin.description){var version=mimeTypes[type].enabledPlugin.description;var versionObj=parseStandardVersion(version);self.raw=versionObj.raw;self.major=versionObj.major;self.minor=versionObj.minor;self.revisionStr=versionObj.revisionStr;self.revision=versionObj.revision;self.installed=true;}}else if(navigator.appVersion.indexOf("Mac")==-1&&window.execScript){var version=-1;for(var i=0;i<activeXDetectRules.length&&version==-1;i++){var obj=getActiveXObject(activeXDetectRules[i].name);if(!obj.activeXError){self.installed=true;version=activeXDetectRules[i].version(obj);if(version!=-1){var versionObj=parseActiveXVersion(version);self.raw=versionObj.raw;self.major=versionObj.major;self.minor=versionObj.minor;self.revision=versionObj.revision;self.revisionStr=versionObj.revisionStr;}}}}
if(self.installed){return self.major+'.'+self.minor;}else{return'-';}};this.setCookie=function(name,value,daysToExpire,absolutePath){var expire='';var path='; path=/';if(daysToExpire){var d=new Date();d.setTime(d.getTime()+(86400000*parseFloat(daysToExpire)));expire='; expires='+d.toGMTString();}
if(absolutePath){path="; path="+absolutePath;}
var cookieValue=escape(name)+'='+escape(value||'')+expire+path;document.cookie=cookieValue;return;};this.getCookie=function(name){var cookie=document.cookie.match(new RegExp(escape(name)+"\\s*=\\s*(.*?)(;|$)"));var cookieValue=cookie?unescape(cookie[1]):null;return(cookieValue);};this.eraseCookie=function(name){var cookie=self.getCookie(name)||true;this.setCookie(name,'',-1);return cookie;};this.acceptCookie=function(){if(typeof navigator.cookieEnabled=='boolean'){return navigator.cookieEnabled;}
this.setCookie('_test','1');return(this.eraseCookie('_test')==='1');};this.setCampName=function(name){self.campaignName=name;};this.setCampSource=function(name){self.campaignSource=name;};this.setCampMedium=function(name){self.campaignMedium=name;};this.setCampContent=function(name){self.campaignContent=name;};this.getUuid=function(len,radix){var CHARS='0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz'.split('');var chars=CHARS,uuid=[],rnd=Math.random;radix=radix||chars.length;if(len){for(var i=0;i<len;i++){uuid[i]=chars[0|rnd()*radix];}}else{var r;uuid[8]=uuid[13]=uuid[18]=uuid[23]='-';uuid[14]='4';for(var i=0;i<36;i++){if(!uuid[i]){r=0|rnd()*16;uuid[i]=chars[(i==19)?(r&0x3)|0x8:r&0xf];}}}
return uuid.join('');};this.getUniqueRequest=function(){return self.getUuid(10,10);};this.parseParameters=function(){var objURL=new Object();window.location.search.replace(new RegExp("([^?=&]+)(=([^&]*))?","g"),function($0,$1,$2,$3){objURL[$1]=$3;});return objURL;};this.trackLink=function(linkId){if(!linkId){return;}
tracker=self;element=document.getElementById(linkId);if(element){href=element.href.replace(/\/#$/,'');f=function(e){tracker.trackPageview(href);if(e.preventDefault){e.preventDefault();}
e.stopPropagation();window.location=this.href;};element.onclick=f;}else{}};this.trackForm=function(form,fieldIds){};this.trackEvent=function(category,action,label,value){data={};data.utcat=category;data.utact=action;if(label){data.utlab=label;}
if(value){data.utval=value;}
this._track(data);};this.trackTrans=function(){};this.getFlashApp=function(appName){if(navigator.appName.indexOf("Microsoft")!=-1){return window[appName];}else{return document[appName];}};this.callFlexApp=function(appName){var player=appName||self.videoPlayer;self.getFlashApp(player).FlexCall();};this.account=account;this.parameters=this.parseParameters();this.urlParams={"utac":this.getAccount,"utses":this.getSession,"utvis":this.getVisitor,"utid":this.getCid,"utmdt":this.getPageTitle,"utmsr":this.getScreenSize,"utmsc":this.getColorDepth,"utmul":this.getLanguage,"utmcs":this.getCharset,"utmfl":this.getFlashVersion,"utmn":this.getUniqueRequest,"utref":this.getReferrer,"uttz":this.getTimeZoneOffset,"utm_campaign":this.getCampName,"utm_source":this.getCampSource,"utm_medium":this.getCampMedium,"utm_content":this.getCampContent,"utmp":this.getUrl};};